<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0 maximum-scale=1">
    <title>Delivery Bot</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script> <!--Подключаем скрипт от телеграм-->
    <link rel="stylesheet" href="/delivery_bot/static/css/main.css">
</head>

<body>
   Авторизация...
   <p class="hint">Админ панель бота</p> <!--Просто текст-подсказка для проверки-->
</body>
<script>
   function sleep(delay) {
       var start = new Date().getTime();
       while (new Date().getTime() < start + delay);
   }

   var xmlhttp = new XMLHttpRequest(); // Создаём объект XMLHTTP
   xmlhttp.open('POST', '/delivery_bot/validate/moder', true); // Открываем асинхронное соединение
   xmlhttp.setRequestHeader('Content-Type', 'application/json'); // Отправляем кодировку
   xmlhttp.send(window.Telegram.WebApp.initData); // Отправляем POST-запрос
   xmlhttp.onreadystatechange = function() { // Ждём ответа от сервера
       if (xmlhttp.readyState == 4) { // Ответ пришёл
          sleep(3);
          if(xmlhttp.status == 200) { // Сервер вернул код 200 (что хорошо)
             window.location.href = `/delivery_bot`;
          }
          else if (xmlhttp.status == 401) window.location.href = '/delivery_bot/unauthorized';
       }
   };


   let tg = window.Telegram.WebApp; //получаем объект webapp телеграма

   tg.expand(); //расширяем на все окно
</script>
</html>